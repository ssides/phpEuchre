<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" href="./content/bootstrap-5.0.2-dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="./content/css/site.css">
  <title>Sides Family Euchre - Play</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="./content/bootstrap-5.0.2-dist/js/bootstrap.min.js"></script>
  <script src="./content/ko/knockout-3.5.1.js"></script>
</head>

<body>
  <!-- beginning of header -->
  <nav class="navbar navbar-expand navbar-dark bg-primary fixed-top">
    <div class="container">
      <a class="navbar-brand" href="#">Sides Family Euchre</a>

      <div id="navbarColor02">
        <span style="color:white">img</span>&nbsp;
        <span style="color:white">Hi logged in user!</span>&nbsp;

        <ul class="navbar-nav me-auto">
          <li class="nav-item ">
            <a class="nav-link">Sign in</a>
          </li>
          <li class="nav-item ">
            <a class="nav-link">Sign out</a>
          </li>
          <li class="nav-item ">
            <a class="nav-link">Profile</a>
          </li>
          <li class="nav-item ">
            <a class="nav-link">Start</a>
          </li>
          <li class="nav-item">
            <a class="nav-link">Sign up</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <!-- end of header -->


  <div class="App">
    <div class="vertical-center">
      <div class="inner-block justify-content-center">
        <table>
          <tr>
            <td>
            </td>
            <td>
              <div id="NorthInfo">
                <div class="info" data-bind="class: infoStatus">
                  <table>
                    <tr>
                      <td style="vertical-align: middle;">
                        <div data-bind="visible: thumbnailURL().length > 0">
                          <img data-bind="attr: {src: thumbnailURL() }" style="height: 15px; width: 15px;" />
                        </div>
                      </td>
                      <td style="vertical-align: middle;">&nbsp;<span data-bind="text: name"></span></td>
                      <td style="vertical-align: middle;">
                        <div class="dealerBorder" data-bind="visible: dealer() != ' '">
                          &nbsp;<span class="dealer" data-bind="text: dealer"></span>
                        </div>
                      </td>
                    </tr>
                  </table>
                </div>
              </div>
            </td>
            <td>
              <div id="MyScore" class="score">
                <div class="scoreBorder">
                  <table>
                    <tr><td><span style="display:none" data-bind="text: label, visible: showScoreGroup"></span><span style="display:none" data-bind="visible: showScoreGroup">:&nbsp;</span><span style="display:none" data-bind="text: score, visible: showScoreGroup"></span></td><td></td></tr>
                    <tr>
                      <td><div class="tricksBorder" data-bind="html: tricks"></div></td>
                      <td>
                        <div class="trump" data-bind="visible: trumpURL().length > 0">
                          <img data-bind="attr: {src: trumpURL }" style="width: 14px; height: 14px; margin-left: 4px;" />
                        </div>
                      </td>
                    </tr>
                  </table>
                </div>
              </div>
            </td>
          </tr>
          <tr>
            <td>
              <div id="WestInfo">
                <div class="info" data-bind="class: infoStatus">
                  <table>
                    <tr>
                      <td style="vertical-align: middle;">
                        <div data-bind="visible: thumbnailURL().length > 0">
                          <img data-bind="attr: {src: thumbnailURL() }" style="height: 15px; width: 15px;" />
                        </div>
                      </td>
                      <td style="vertical-align: middle;">&nbsp;<span data-bind="text: name"></span></td>
                      <td style="vertical-align: middle;">
                        <div class="dealerBorder" data-bind="visible: dealer() != ' '">
                          &nbsp;<span class="dealer" data-bind="text: dealer"></span>
                        </div>
                      </td>
                    </tr>
                  </table>
                </div>
              </div>
            </td>
            <td>
              <div id="PlayTable">
                <table class="playTable">
                  <thead>
                    <tr>
                      <td style="width: 75px; text-alight:right;"></td>
                      <td style="width: 54px;"></td>
                      <td style="width: 75px; text-alight:left"></td>
                    </tr>
                  </thead>
                  <tbody>
                    <tr style="height: 58px">
                      <td>
                      </td>
                      <td>
                        <!-- <div id="sfeN" style="display:none" class="flip-container-p"> -->
                        <!-- <div class="flipper-p"> -->
                        <!-- <div class="back-p"> -->
                        <!-- <img src="<?php echo $appUrl; ?>content/images/cards/cardback.png" style="width:<?php echo $cardImageWidth; ?>px;height:<?php echo $cardImageHeight; ?>px;"> -->
                        <!-- </div> -->
                        <!-- <div class="front-p"> -->
                        <!-- <img src="<?php echo $appUrl; ?>content/images/cards/AS.png" style="width:<?php echo $cardImageWidth; ?>px;height:<?php echo $cardImageHeight; ?>px;"> -->
                        <!-- </div> -->
                        <!-- </div> -->
                        <!-- </div> -->
                        <div id="sfeJN" data-bind="visible: nCardURL().length > 0">
                          <img data-bind="attr: {src: nCardURL}" style="width:40px;height:55px; rotate: 180deg;" />
                        </div>
                      </td>
                      <td></td>
                    </tr>
                    <tr style="height: 42px">
                      <td>
                        <!-- <div id="sfeW" style="display:none" class="flip-container-l" "> -->
                        <!-- <div class="flipper-l"> -->
                        <!-- <div class="back-l"> -->
                        <!-- <img src="<?php echo $appUrl; ?>content/images/cards/cardback.png" style="width:40px;height:55px; rotate: 90deg;"> -->
                        <!-- </div> -->
                        <!-- <div class="front-l"> -->
                        <!-- <img src="<?php echo $appUrl; ?>content/images/cards/AC.png" style="width:40px;height:55px; rotate: 90deg; transform: translate(40px,0);"> -->
                        <!-- </div> -->
                        <!-- </div> -->
                        <!-- </div> -->
                        <div id="sfeJW" data-bind="visible: wCardURL().length > 0">
                          <img data-bind="attr: {src: wCardURL }" style="width:40px;height:55px; rotate: 90deg; transform: translate(0,-14px);" />
                        </div>
                      </td>
                      <td>
                        <div id="cardFaceUp" style="display:none" data-bind="visible: faceupCardURL().length > 0">
                          <img data-bind="attr: {src: faceupCardURL }" style="width:40px;height:55px;" />
                        </div>

                        <!-- this works on every device except iPad.  :-(
                        <div id="cardFaceUp" style="display:none" class="flip-container-p">
                          <div class="flipper-p">
                            <div class="back-p">
                              <img src="<?php echo $appUrl; ?>content/images/cards/cardback.png" style="width:40px;height:55px;">
                            </div>
                            <div class="front-p">
                              <img data-bind="attr: {src: faceupCardURL }" style="width:40px;height:55px;">
                            </div>
                          </div>
                        </div>
                        -->

                      </td>
                      <td>
                        <!-- <div id="sfeE" style="display:none" class="flip-container-l"> -->
                        <!-- <div class="flipper-l"> -->
                        <!-- <div class="back-l"> -->
                        <!-- <img src="<?php echo $appUrl; ?>content/images/cards/cardback.png" style="width:40px;height:55px; rotate: -90deg;"> -->
                        <!-- </div> -->
                        <!-- <div class="front-l"> -->
                        <!-- <img src="<?php echo $appUrl; ?>content/images/cards/AH.png" style="width:40px;height:55px; rotate: -90deg; transform: translate(-40px,0); "> -->
                        <!-- </div> -->
                        <!-- </div> -->
                        <!-- </div> -->
                        <div id="sfeJE" data-bind="visible: eCardURL().length > 0">
                          <img data-bind="attr: {src: eCardURL }" style="width:40px;height:55px; rotate: -90deg; transform: translate(0,14px);" />
                        </div>
                      </td>
                    </tr>
                    <tr style="height: 58px">
                      <td></td>
                      <td>
                        <!-- <div id="sfeS" style="display:none" class="flip-container-p"> -->
                        <!-- <div class="flipper-p"> -->
                        <!-- <div class="back-p"> -->
                        <!-- <img src="<?php echo $appUrl; ?>content/images/cards/cardback.png" style="width:40px;height:55px;"> -->
                        <!-- </div> -->
                        <!-- <div class="front-p"> -->
                        <!-- <img src="<?php echo $appUrl; ?>content/images/cards/AS.png" style="width:40px;height:55px;"> -->
                        <!-- </div> -->
                        <!-- </div> -->
                        <!-- </div> -->
                        <div id="sfeJS" data-bind="visible: sCardURL().length > 0">
                          <img data-bind="attr: {src: sCardURL }" style="width:40px;height:55px;" />
                        </div>
                      </td>
                      <td></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </td>
            <td>
              <div id="EastInfo">
                <div class="info" data-bind="class: infoStatus">
                  <table>
                    <tr>
                      <td style="vertical-align: middle;">
                        <div data-bind="visible: thumbnailURL().length > 0">
                          <img data-bind="attr: {src: thumbnailURL() }" style="height: 15px; width: 15px;" />
                        </div>
                      </td>
                      <td style="vertical-align: middle;">&nbsp;<span data-bind="text: name"></span></td>
                      <td style="vertical-align: middle;">
                        <div class="dealerBorder" data-bind="visible: dealer() != ' '">
                          &nbsp;<span class="dealer" data-bind="text: dealer"></span>
                        </div>
                      </td>
                    </tr>
                  </table>
                </div>
              </div>
            </td>
          </tr>
          <tr>
            <td>
              <div id="OpponentScore" class="score">
                <div class="scoreBorder">
                  <table>
                    <tr><td><span style="display:none" data-bind="text: label, visible: showScoreGroup"></span><span style="display:none" data-bind="visible: showScoreGroup">:&nbsp;</span><span style="display:none" data-bind="text: score, visible: showScoreGroup"></span></td><td></td></tr>
                    <tr>
                      <td><div class="tricksBorder" data-bind="html: tricks"></div></td>
                      <td>
                        <div class="trump" data-bind="visible: trumpURL().length > 0">
                          <img data-bind="attr: {src: trumpURL }" style="width: 14px; height: 14px; margin-left: 4px;" />
                        </div>
                      </td>
                    </tr>
                  </table>
                </div>
              </div>
            </td>
            <td colspan=2>
              <div id="SouthInfo">
                <div class="info container" data-bind="class: isMyTurn() ? 'infoTurnBorder': 'infoBorder'">
                  <div class="row">
                    <div class="col">
                      <div class="dealerBorder" data-bind="visible: dealer() != ' '">
                        &nbsp;<span class="dealer" data-bind="text: dealer"></span>
                      </div>
                    </div>
                    <div class="col">
                      <ul class="list-group list-group-horizontal" data-bind="foreach: sortedCards">
                        <li class="list-group-item p-0" style="height:29px; width: 29px" data-bind="click: $parent.selectCard">
                          <div class="cardSelectionContainer">
                            <div class="cardSelecter" data-bind="class: isSelected() ? 'cardSelected' : ''">
                              <div style="margin: 2px; padding: 0px;" class="cardContainer" data-bind="class: isPlayable() ? '' : 'cardNotPlayable'">
                                <img class="clipCard" data-bind="attr: {src: url}" />
                              </div>
                            </div>
                          </div>
                        </li>
                      </ul>
                    </div>
                    <div class="col">
                      <button id="discard" type="button" style="display:none" data-bind="visible: showDiscardBtn, enable: enableDiscardBtn, click: discard">Discard</button>
                      <button id="play" type="button" style="display:none" data-bind="visible: showPlayBtn, enable: enablePlayBtn, click: play">Play</button>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col pt-1">
                      <button id="pass" type="button" style="display:none" data-bind="visible: showPassBtn, enable: enablePassBtn, click: pass">Pass</button>
                      <button id="pickitup" type="button" style="display:none" data-bind="visible: showPickItUpGroup, enable: enablePickItUpGroup, click: pickItUp">Pick it up</button>&nbsp;<input type="checkbox" data-bind="visible: showPickItUpGroup, enable: enablePickItUpGroup, checked: obsAlone" style="display:none" name="alone" value="alone" /><label id="lblAlone" style="display:none" for="alone" data-bind="visible: showPickItUpGroup, enable: enablePickItUpGroup">&nbsp;Alone</label>
                    </div>
                  </div>
                </div>
              </div>
            </td>
          </tr>
        </table>
        <div id="demo" class="row">
          <div class="col">
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#bidModal"> demo: show bid modal </button>
          </div>
          <div class="col">
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#endGameModal"> show end modal </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div class="modal fade" id="bidModal" tabindex="-1" aria-labelledby="bidModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="exampleModalLabel">Choose Trump</h1>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col">
              <ul class="list-group list-group-horizontal" data-bind="foreach: suits">
                <li class="list-group-item p-0" data-bind="click: $parent.selectSuit">
                  <div class="suitContainer">
                    <div data-bind="class: isSelected() ? 'cardSelected' : ''">
                      <div class="suitSelecter" data-bind="class: isPlayable() ? '' : 'cardNotPlayable'">
                        <img class="suitSize" data-bind="attr: {src: url}" />
                      </div>
                    </div>
                  </div>
                </li>
              </ul>
              &nbsp;&nbsp;&nbsp;<input type="checkbox" name="alone" value="alone" data-bind="checked: alone" /><label id="lblAlone" for="alone">&nbsp;Alone</label>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" data-bind="visible: showPassBtn, enable: enablePassBtn, click: pass">Pass</button>
            <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Submit</button>

          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div class="modal fade" id="endGameModal" tabindex="-1" aria-labelledby="bidModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="exampleModalLabel">Game Over</h1>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col">
              <div>
                <div>Winner:</div>
                <span data-bind="text: winner()"></span>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col">
              <div>
                <span data-bind="text: loser()"></span>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col">
              <div class="endGameDate">
                <span data-bind="text: dateStr()"></span>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" data-bs-dismiss="modal">OK</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="./content/js/demo/app.js"></script>
  <script src="./content/js/demo/gameModel.js"></script>
  <script src="./content/js/demo/currentPlayerInfoViewModel.js"></script>
  <script src="./content/js/demo/playerInfoViewModel.js"></script>
  <script src="./content/js/demo/scoreViewModel.js"></script>
  <script src="./content/js/demo/playViewModel.js"></script>
  <script src="./content/js/demo/bidDialogViewModel.js"></script>
  <script src="./content/js/demo/endGameDialogViewModel.js"></script>

  <script type="text/javascript">

    // The gameController is responsible for calling on viewmodels to update the score, and do animations on
    // the play table.  The main interval timer is the getGameInterval which runs throughout the game.
    // The computer used by the Organizer does the scoring of the game.  So if the Organizer's Partner goes
    // alone, the Organizer's gameController must continue to be active. (I say that because when my iPhone
    // goes to sleep, javascript processes stop running.)
    function gameController() {
      var self = this;

      self.game = new gameModel({});
      self.bidModal = new bootstrap.Modal($('#bidModal'));
      self.endGameModal = new bootstrap.Modal($('#endGameModal'));
      self.nPlayerInfoVM = new playerInfoViewModel();
      self.ePlayerInfoVM = new playerInfoViewModel();
      self.wPlayerInfoVM = new playerInfoViewModel();
      self.playerInfoVM = new currentPlayerInfoViewModel();
      self.myScoreVM = new scoreViewModel();
      self.opponentScoreVM = new scoreViewModel();
      self.playVM = new playViewModel();
      self.bidDialogVM = new bidDialogViewModel();
      self.endGameDialogVM = new endGameDialogViewModel();

      self.initialize = function () {
        self.game = new gameModel({
          OrganizerScore: 3,
          OpponentScore: 2,
          OrganizerTricks: 2,
          OpponentTricks: 1,
          OrganizerTrump: 'D',
          OpponentTrump: '',
          OName: 'Steve',
          PName: 'Judy',
          LName: 'Chris',
          RName: 'James'
        });

        self.game.Turn = app.positions[Math.floor(Math.random() * app.positions.length)];

        self.opponentScoreVM.initialize('M', 'O', self.game);
        self.myScoreVM.initialize('O', 'O', self.game);

        self.opponentScoreVM.update(self.game);
        self.myScoreVM.update(self.game);

        self.playerInfoVM.initialize('O', self.game);
        self.playerInfoVM.update(self.game, 'abcdefg');

        self.nPlayerInfoVM.initialize('N', 'O', self.game);
        self.nPlayerInfoVM.update(self.game);

        self.ePlayerInfoVM.initialize('E', 'O', self.game);
        self.ePlayerInfoVM.update(self.game);

        self.wPlayerInfoVM.initialize('W', 'O', self.game);
        self.wPlayerInfoVM.update(self.game);

        self.playVM.nCardURL(app.getCardURL('9C'));
        self.playVM.sCardURL(app.getCardURL('1S'));
        self.playVM.eCardURL(app.getCardURL('9H'));
        self.playVM.wCardURL(app.getCardURL('1H'));

      };

      self.initialize();
    }

    $(function () {
      var gc = new gameController();
      ko.applyBindings(gc.nPlayerInfoVM, $('#NorthInfo')[0]);
      ko.applyBindings(gc.ePlayerInfoVM, $('#EastInfo')[0]);
      ko.applyBindings(gc.wPlayerInfoVM, $('#WestInfo')[0]);
      ko.applyBindings(gc.myScoreVM, $('#MyScore')[0]);
      ko.applyBindings(gc.opponentScoreVM, $('#OpponentScore')[0]);
      ko.applyBindings(gc.playVM, $('#PlayTable')[0]);
      ko.applyBindings(gc.playerInfoVM, $('#SouthInfo')[0]);
      ko.applyBindings(gc.bidDialogVM, $('#bidModal')[0]);
      ko.applyBindings(gc.endGameDialogVM, $('#endGameModal')[0]);
    });

  </script>
</body>

</html>